<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>CATIA and SIMULIA Scripting and Automation with Python - if curious: then learn</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <link href="http://ifcuriousthenlearn.com/images/earth.png" rel="icon">

<link rel="canonical" href="http://ifcuriousthenlearn.com/blog/2015/06/10/catia-and-simulia-scripting-and-automation-with-python/">

        <meta name="author" content="Neal Gordon" />
        <meta name="keywords" content="python,CAD,FEA" />
        <meta name="description" content="Script to perform finite element analysis in CATIA CAD software" />

        <meta property="og:site_name" content="if curious: then learn" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="CATIA and SIMULIA Scripting and Automation with Python"/>
        <meta property="og:url" content="http://ifcuriousthenlearn.com/blog/2015/06/10/catia-and-simulia-scripting-and-automation-with-python/"/>
        <meta property="og:description" content="Script to perform finite element analysis in CATIA CAD software"/>
        <meta property="article:published_time" content="2015-06-10" />
            <meta property="article:section" content="Engineering" />
            <meta property="article:tag" content="python" />
            <meta property="article:tag" content="CAD" />
            <meta property="article:tag" content="FEA" />
            <meta property="article:author" content="Neal Gordon" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://ifcuriousthenlearn.com/theme/css/bootstrap.journal.min.css" type="text/css"/>
    <link href="http://ifcuriousthenlearn.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://ifcuriousthenlearn.com/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="http://ifcuriousthenlearn.com/theme/css/style.css" type="text/css"/>

        <link href="http://ifcuriousthenlearn.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="if curious: then learn ATOM Feed"/>



        <link href="http://ifcuriousthenlearn.com/feeds/engineering.atom.xml" type="application/atom+xml" rel="alternate"
              title="if curious: then learn Engineering ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://ifcuriousthenlearn.com/" class="navbar-brand">
if curious: then learn            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="http://ifcuriousthenlearn.com/pages/about-me.html">
                             About me
                          </a></li>
                        <li >
                            <a href="http://ifcuriousthenlearn.com/category/aviation.html">Aviation</a>
                        </li>
                        <li >
                            <a href="http://ifcuriousthenlearn.com/category/computing.html">Computing</a>
                        </li>
                        <li class="active">
                            <a href="http://ifcuriousthenlearn.com/category/engineering.html">Engineering</a>
                        </li>
                        <li >
                            <a href="http://ifcuriousthenlearn.com/category/tools.html">Tools</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://ifcuriousthenlearn.com/blog/2015/06/10/catia-and-simulia-scripting-and-automation-with-python/"
                       rel="bookmark"
                       title="Permalink to CATIA and SIMULIA Scripting and Automation with Python">
                        CATIA and SIMULIA Scripting and Automation with Python
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-06-10T00:00:00-04:00"> 2015-06-10</time>
    </span>


            <span class="label label-default">By</span>
            <a href="http://ifcuriousthenlearn.com/author/neal-gordon.html"><i class="fa fa-user"></i> Neal Gordon</a>



<span class="label label-default">Tags</span>
	<a href="http://ifcuriousthenlearn.com/tag/python.html">python</a>
        /
	<a href="http://ifcuriousthenlearn.com/tag/cad.html">CAD</a>
        /
	<a href="http://ifcuriousthenlearn.com/tag/fea.html">FEA</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="CATIA-and-SIMULIA-Scripting-and-Automation-with-Python">CATIA and SIMULIA Scripting and Automation with Python<a class="anchor-link" href="#CATIA-and-SIMULIA-Scripting-and-Automation-with-Python">¶</a></h1><p><strong>Jun 9, 2015</strong></p>
<h2 id="Introduction">Introduction<a class="anchor-link" href="#Introduction">¶</a></h2><div id="sec:int"></div><p>CATIA is a 3D parametric modelling program that is ubiquitous in large engineering and manufacturing firms. SIMULIA is a finite element simulation package integrated into CATIA that allows for complex and powerful analysis to be performed on exiting models and assemblies with relative ease. This demonstration is two-fold. First, is to give the user an example of how a simple python script can be used to generate a solid model. The second is to use the same scripting capabilities to run a simple FEA simulation. The ideas here can be extrapolated with the assistance of the references found in (<a href="#sec:ref">References</a>).
Computer aided engineering (CAE) requires a solid understanding of computer software, specifically CAD surface and solid modelling systems and FEA analysis. Not required, but highly useful is having the capability to not only read, but write computer code. An excellent language that is compatible in most operating systems, is open-source(free), and has powerful engineering libraries is python. A demonstration of python is given to show how simple tasks in CATIA can be automated to improve analysis consistency and repeatability and save time. CATIA natively uses Visual Basic for Applications (VBA) <a href="#ziethen_catia_2013">[ziethen_catia_2013]</a>. However, VBA is limited in functionality, especially when data analysis and plotting are desired. Python is a much more capable engineering language that works with many programs, such as Microsoft Excel, and many other programs to utilize VBA <a href="#hammond_python_2000">[hammond_python_2000]</a>. Finally, the demonstration here is based on an excellent site  <a href="#woyand_h.b._mechanical_2015">[woyand_h.b._mechanical_2015]</a> that has many engineering applications for python.</p>
<h2 id="Walkthrough">Walkthrough<a class="anchor-link" href="#Walkthrough">¶</a></h2><div id="sec:exm"></div><p>The final result will be a model that can be easily edited and simulation results where visualization  that allows for a more in-depth analysis of the component.</p>
<div id="fig:vonmises"></div><p><p>Stress result of simulation</p>
<img src="/notebooks/CATIA-and-SIMULIA-Scripting-and-Automation-with-Python/vonmises.png" width="600" /></p>
<h3 id="CATIA-Setup">CATIA Setup<a class="anchor-link" href="#CATIA-Setup">¶</a></h3><p>To prepare CATIA for script execution, it is recommended to launch a new instance of CATIA and close any files that are automatically created, as show in .</p>
<div id="fig:catia"></div><p><p>Start CATIA with no files open</p>
<img src="/notebooks/CATIA-and-SIMULIA-Scripting-and-Automation-with-Python/catia.png" width="600" /></p>
<h3 id="Python-Setup">Python Setup<a class="anchor-link" href="#Python-Setup">¶</a></h3><p>Python is open-source and can be freely downloaded without licensing restrictions. I recommend either <a href="http://continuum.io/downloads">Anaconda Python 2.7</a> or <a href="http://www.pyzo.org/downloads.html">Pyzo</a>. Once the software is installed, retrieve the python script at the end of this post. Now, the python script can be executed via the command line argument:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<pre><code>    python CATIA-and-SIMULIA-Scripting-and-Automation-with-Python.py</code></pre>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Execution-and-explanation-of-the-Code">Execution and explanation of the Code<a class="anchor-link" href="#Execution-and-explanation-of-the-Code">¶</a></h3><p>The very first operation of python is to import the modules that are used. Then, the python kernal attempts to connect to the CATIA application running in windows</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># import python modules</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">win32com.client</span> <span class="k">import</span> <span class="n">Dispatch</span>
<span class="c1"># Connecting to windows COM </span>
<span class="n">CATIA</span> <span class="o">=</span> <span class="n">Dispatch</span><span class="p">(</span><span class="s1">'CATIA.Application'</span><span class="p">)</span>
<span class="c1"># optional CATIA visibility</span>
<span class="n">CATIA</span><span class="o">.</span><span class="n">Visible</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, a <code>Part</code> and <code>Sketch</code>  are created in CATIA Part Design workbench</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create an empty part</span>
<span class="n">partDocument1</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">Documents</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="s2">"Part"</span><span class="p">)</span>

<span class="c1"># Create the point that the plane and sketch reference</span>
<span class="n">Xcoord</span><span class="o">=</span><span class="mi">100</span>
<span class="n">Ycoord</span><span class="o">=</span><span class="mi">100</span>
<span class="n">Zcoord</span><span class="o">=</span><span class="mi">100</span>
<span class="n">NewPoint</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">HybridShapeFactory</span><span class="o">.</span><span class="n">AddNewPointCoord</span><span class="p">(</span><span class="n">Xcoord</span><span class="p">,</span> <span class="n">Ycoord</span><span class="p">,</span> <span class="n">Zcoord</span><span class="p">)</span>
<span class="n">Mainbody</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">MainBody</span>
<span class="n">Mainbody</span><span class="o">.</span><span class="n">InsertHybridShape</span><span class="p">(</span><span class="n">NewPoint</span><span class="p">)</span>

<span class="c1"># Create reference plane for sketch</span>
<span class="n">AxisXY</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">OriginElements</span><span class="o">.</span><span class="n">PlaneXY</span>
<span class="n">Referenceplane</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">CreateReferenceFromObject</span><span class="p">(</span><span class="n">AxisXY</span><span class="p">)</span>
<span class="n">Referencepoint</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">CreateReferenceFromObject</span><span class="p">(</span><span class="n">NewPoint</span><span class="p">)</span>
<span class="n">NewPlane</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">HybridShapeFactory</span><span class="o">.</span><span class="n">AddNewPlaneOffsetPt</span><span class="p">(</span><span class="n">Referenceplane</span><span class="p">,</span> <span class="n">Referencepoint</span><span class="p">)</span>
<span class="n">Mainbody</span><span class="o">.</span><span class="n">InsertHybridShape</span><span class="p">(</span><span class="n">NewPlane</span><span class="p">)</span>

<span class="c1"># create sketch</span>
<span class="n">sketches1</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">Bodies</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="s2">"PartBody"</span><span class="p">)</span><span class="o">.</span><span class="n">Sketches</span>
<span class="n">reference1</span> <span class="o">=</span> <span class="n">partDocument1</span><span class="o">.</span><span class="n">part</span><span class="o">.</span><span class="n">OriginElements</span><span class="o">.</span><span class="n">PlaneXY</span>
<span class="n">NewSketch</span> <span class="o">=</span> <span class="n">sketches1</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">reference1</span><span class="p">)</span>
<span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">InWorkObject</span> <span class="o">=</span> <span class="n">NewSketch</span>

<span class="c1">#Drawing the sketch</span>
<span class="n">NewSketch</span><span class="o">.</span><span class="n">OpenEdition</span><span class="p">()</span>
<span class="c1">#                                  Start (H,   V)  End(H,V)</span>
<span class="n">NewLine1</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">0</span>  <span class="p">,</span> <span class="mi">0</span>  <span class="p">,</span> <span class="mi">0</span>   <span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">NewLine2</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">0</span>  <span class="p">,</span> <span class="mi">50</span> <span class="p">,</span> <span class="mi">50</span>  <span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">NewLine3</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">50</span> <span class="p">,</span> <span class="mi">50</span> <span class="p">,</span> <span class="mi">50</span>  <span class="p">,</span><span class="mi">55</span><span class="p">)</span>
<span class="n">NewLine4</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">50</span> <span class="p">,</span> <span class="mi">55</span> <span class="p">,</span> <span class="mi">150</span> <span class="p">,</span><span class="mi">55</span><span class="p">)</span>
<span class="n">NewLine5</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">55</span> <span class="p">,</span> <span class="mi">150</span>  <span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="n">NewLine6</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span> <span class="p">,</span> <span class="mi">50</span>  <span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">NewLine7</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">50</span> <span class="p">,</span> <span class="o">-</span><span class="mi">5</span> <span class="p">,</span> <span class="mi">75</span>  <span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="n">NewLine8</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">150</span> <span class="p">,</span> <span class="o">-</span><span class="mi">5</span> <span class="p">,</span> <span class="mi">125</span>  <span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="n">NewLine9</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">125</span> <span class="p">,</span> <span class="o">-</span><span class="mi">5</span> <span class="p">,</span> <span class="mi">125</span>  <span class="p">,</span><span class="mi">25</span><span class="p">)</span>
<span class="n">NewLine0</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">125</span> <span class="p">,</span> <span class="mi">25</span> <span class="p">,</span> <span class="mi">75</span>  <span class="p">,</span><span class="mi">25</span><span class="p">)</span>
<span class="n">NewLine11</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">75</span> <span class="p">,</span> <span class="mi">25</span> <span class="p">,</span> <span class="mi">75</span>  <span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="n">NewLine12</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">50</span> <span class="p">,</span> <span class="mi">0</span>  <span class="p">,</span> <span class="mi">0</span>   <span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">NewSketch</span><span class="o">.</span><span class="n">CloseEdition</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, a pad/extrusion operation gives the 2D sketch volume.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create a pad from sketch</span>
<span class="n">LengthBlock</span><span class="o">=</span><span class="mi">50</span>
<span class="n">NewBlock</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">ShapeFactory</span><span class="o">.</span><span class="n">AddNewPad</span> <span class="p">(</span><span class="n">NewSketch</span><span class="p">,</span> <span class="n">LengthBlock</span><span class="p">)</span>
<span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div id="fig:sketch"></div><p><p>Sketch defining the shape</p>
<img src="/notebooks/CATIA-and-SIMULIA-Scripting-and-Automation-with-Python/sketch.png" width="600" /></p>
<p>The material properties  are tricky to assign via scripting, but as long as the <em>CATMaterial</em> file location is known, then it is recommended to hard code. During the python script execution, CATIA should show the activity of the script because we have the value <em>CATIA.Visible = True</em> set. When the script completes(~30 seconds), the results can be manipulated as usual in CATIA.</p>
<p><table border="1"></table></p>
<p><thead></thead></p>
<p><tr><th align="center">    Property    </th> <th align="center">          Value           </th> </tr>
</thead></p>
<p><tbody></tbody></p>
<p><tr><td align="center">   Material            </td> <td align="center">   Steel                         </td> </tr></p>
<p><tr><td align="center">   Young's modulus     </td> <td align="center">   200 GPa                       </td> </tr></p>
<p><tr><td align="center">   Poisson's ratio     </td> <td align="center">   0.266                         </td> </tr></p>
<p><tr><td align="center">   Yield strength      </td> <td align="center">   250 MPa                       </td> </tr></p>
<p><tr><td align="center">   Element Type        </td> <td align="center">   Parabolic Tetrahedron-TE10    </td> </tr></p>
<p><tr><td align="center">   Element Count       </td> <td align="center">   74671                         </td> </tr></p>
<p><tr><td align="center">   Node Count          </td> <td align="center">   113760                        </td> </tr></p>
<p><tr><td align="center">   Number of D.O.F.    </td> <td align="center">   341280                        </td> </tr>
</tbody>
</table>
Table 1: Properties of the material simulated and FEA model <div id="tbl:props"></div></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Assign Material</span>
<span class="n">MatManager</span><span class="o">=</span><span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">GetItem</span><span class="p">(</span><span class="s2">"CATMatManagerVBExt"</span><span class="p">)</span>
<span class="n">hk</span><span class="o">=</span><span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">MainBody</span>
<span class="n">systempath</span><span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">SystemService</span><span class="o">.</span><span class="n">Environ</span><span class="p">(</span><span class="s2">"CATDocView"</span><span class="p">)</span>
<span class="n">path</span><span class="o">=</span> <span class="s2">"C:</span><span class="se">\\</span><span class="s2">Program Files</span><span class="se">\\</span><span class="s2">Dassault Systemes</span><span class="se">\\</span><span class="s2">B23\win_b64</span><span class="se">\\</span><span class="s2">startup</span><span class="se">\\</span><span class="s2">materials</span><span class="se">\\</span><span class="s2">Catalog.CATMaterial"</span>
<span class="n">MatDoc</span><span class="o">=</span><span class="n">CATIA</span><span class="o">.</span><span class="n">Documents</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">oMaterial</span><span class="o">=</span><span class="n">MatDoc</span><span class="o">.</span><span class="n">Families</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="s2">"Metal"</span><span class="p">)</span><span class="o">.</span><span class="n">Materials</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="s2">"Steel"</span><span class="p">)</span>
<span class="n">MatManager</span><span class="o">.</span><span class="n">ApplyMaterialOnBody</span> <span class="p">(</span><span class="n">hk</span><span class="p">,</span><span class="n">oMaterial</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">MatDoc</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now lets get our hands dirty with the CATIA Generative Structural Analysis (GPS) workbench. This snippet of code will allows to create our mesh from the 3D solid body we just created. The parameters for the FE model must be assigned, and SIMULIA makes meshing very easy. It done automatically and the resultant properties are shown in table</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Activate the Generative Structural Analysis (GPS) Workbench</span>
<span class="n">PartDoc</span><span class="o">=</span><span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span>
<span class="n">CATIA</span><span class="o">.</span><span class="n">StartWorkbench</span> <span class="p">(</span><span class="s2">"GPSCfg"</span><span class="p">)</span>
<span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">Import</span><span class="p">(</span><span class="n">PartDoc</span><span class="p">)</span>
<span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">AnalysisModels</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">RunTransition</span> <span class="p">(</span><span class="s2">"CATGPSStressAnalysis_template"</span><span class="p">)</span>
<span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveWindow</span><span class="o">.</span><span class="n">ActiveViewer</span><span class="o">.</span><span class="n">Reframe</span> <span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The mesh parameters can be adjusted to depending on the desired accuracy of the results and run-time. These default settings will take about 60 seconds to run on an i7 intel processor with 8 GB of RAM.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create a Mesh</span>
<span class="n">mesh</span><span class="o">=</span><span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">AnalysisModels</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">MeshManager</span><span class="o">.</span><span class="n">AnalysisMeshParts</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">SetGlobalSpecification</span> <span class="p">(</span><span class="s2">"SizeValue"</span><span class="p">,</span> <span class="s2">"2.5 mm"</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">SetGlobalSpecification</span> <span class="p">(</span><span class="s2">"AbsoluteSag"</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">SetGlobalSpecification</span> <span class="p">(</span><span class="s2">"AbsoluteSagValue"</span><span class="p">,</span> <span class="s2">"1.0 mm"</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">SetGlobalSpecification</span> <span class="p">(</span><span class="s2">"ElementOrder"</span><span class="p">,</span> <span class="s2">"Parabolic"</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The constraints used are a clamp of one side of the body. This constrains all 6 degrees of freedom (dof) for the elements on that face. The load is a distributed force on the inside of the component</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Define Constraints</span>
<span class="n">analysisSet1</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">AnalysisModels</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">AnalysisCases</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">AnalysisSets</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">analysisEntity1</span> <span class="o">=</span> <span class="n">analysisSet1</span><span class="o">.</span><span class="n">AnalysisEntities</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="s2">"SAMClamp"</span><span class="p">)</span>
<span class="n">reference1</span> <span class="o">=</span> <span class="n">partDocument1</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">CreateReferenceFromName</span><span class="p">(</span><span class="s2">"Selection_RSur:(Face:(Brp:(Pad.1;0:(Brp:(Sketch.1;12)));None:();Cf11:());Pad.1_ResultOUT;Last;Z0;G4720)"</span><span class="p">)</span>
<span class="n">analysisEntity1</span><span class="o">.</span><span class="n">AddSupportFromProduct</span> <span class="p">(</span><span class="n">partDocument1</span><span class="o">.</span><span class="n">Product</span><span class="p">,</span> <span class="n">reference1</span><span class="p">)</span>

<span class="c1"># Defining the Load</span>
<span class="n">analysisSet2</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">AnalysisModels</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">AnalysisCases</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">AnalysisSets</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">analysisEntity2</span> <span class="o">=</span> <span class="n">analysisSet2</span><span class="o">.</span><span class="n">AnalysisEntities</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="s2">"SAMDistributedForce"</span><span class="p">)</span>
<span class="n">reference2</span> <span class="o">=</span> <span class="n">partDocument1</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">CreateReferenceFromName</span><span class="p">(</span><span class="s2">"Selection_RSur:(Face:(Brp:(Pad.1;0:(Brp:(Sketch.1;5)));None:();Cf11:());Pad.1_ResultOUT;Last;Z0;G4720)"</span><span class="p">)</span>
<span class="n">analysisEntity2</span><span class="o">.</span><span class="n">AddSupportFromProduct</span> <span class="p">(</span><span class="n">partDocument1</span><span class="o">.</span><span class="n">Product</span><span class="p">,</span> <span class="n">reference2</span><span class="p">)</span> <span class="c1">#partDocument1 aus "leeres Part erstellen"</span>
<span class="n">basicComponent1</span> <span class="o">=</span> <span class="n">analysisEntity2</span><span class="o">.</span><span class="n">BasicComponents</span><span class="o">.</span><span class="n">GetItem</span><span class="p">(</span><span class="s2">"SAMForceAxis.1"</span><span class="p">)</span>
<span class="n">basicComponent1</span><span class="o">.</span><span class="n">SetValue</span> <span class="p">(</span><span class="s2">"Values"</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">basicComponent2</span> <span class="o">=</span> <span class="n">analysisEntity2</span><span class="o">.</span><span class="n">BasicComponents</span><span class="o">.</span><span class="n">GetItem</span><span class="p">(</span><span class="s2">"SAMForceVector.1"</span><span class="p">)</span>
<span class="n">basicComponent2</span><span class="o">.</span><span class="n">SetDimensions</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">basicComponent2</span><span class="o">.</span><span class="n">SetValue</span> <span class="p">(</span><span class="s2">"Values"</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">basicComponent2</span><span class="o">.</span><span class="n">SetValue</span> <span class="p">(</span><span class="s2">"Values"</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1500.0</span><span class="p">)</span>
<span class="n">basicComponent2</span><span class="o">.</span><span class="n">SetValue</span> <span class="p">(</span><span class="s2">"Values"</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To submit this finite element model for computation the following code can be executed</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Perform Calculation</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Performing Calculaution'</span><span class="p">)</span>
<span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">AnalysisModels</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">AnalysisCases</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Compute</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Calculaution Complete'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Once the execution is complete, the CATIA graphical user interface (GUI) can be used to navigate and visualize the data fields generated, such as stress, strain, as well as displacement scalars. However, if raw data is desired, then it is relatively simple to export data to text files, which can be opened with excel, or python! Check out <a href="http://www.scipy.org/">scipy</a> for many more tools for engineering analysis using python</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Export text file with von-mises stress</span>
<span class="n">analysisSet1</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">AnalysisModels</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">AnalysisCases</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">AnalysisSets</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">analysisImage1</span> <span class="o">=</span> <span class="n">analysisSet1</span><span class="o">.</span><span class="n">AnalysisImages</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="s2">"StressVonMises_Iso_Smooth"</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">Folder</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">FileSystem</span><span class="o">.</span><span class="n">GetFolder</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="n">analysisImage1</span><span class="o">.</span><span class="n">ExportDataInGlobalAxis</span><span class="p">(</span><span class="n">Folder</span><span class="p">,</span> <span class="s2">"mises"</span><span class="p">,</span> <span class="s2">"txt"</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Created stress text file"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div id="fig:vonmisesani"></div><p><p>Animated stress</p>
<img src="/notebooks/CATIA-and-SIMULIA-Scripting-and-Automation-with-Python/vonmises.gif" width="600" /></p>
<p>Finally, after the computation, the von-mises stress results are shown in figure .</p>
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>A method utilizing CATIA CAD, SIMULIA FEA and python programming language is presented as a method for improving modelling and analysis by automating the steps required to acquire simulation results.</p>
<h2 id="References">References<a class="anchor-link" href="#References">¶</a></h2><div id="sec:ref"></div><ol>
<li><p><div id="ziethen_catia_2013"></div> <strong>D. Ziethen</strong>. 
<em>CATIA V5 Macro Programming With Visual Basic Script</em>,
McGraw-Hill,
2013,
<a href="http://www.mhprofessional.com/product.php?isbn=0071800026">http://www.mhprofessional.com/product.php?isbn=0071800026</a>.</p>
</li>
<li><p><div id="hammond_python_2000"></div> <strong>M. Hammond and A. Robinson</strong>. 
<em>Python Programming on Win32</em>,
O'Reilly Media,
2000,
<a href="http://shop.oreilly.com/product/9781565926219.do">http://shop.oreilly.com/product/9781565926219.do</a>.</p>
</li>
<li><p><div id="woyand_h.b._mechanical_2015"></div> <strong>H. Woyand</strong>. 
Mechanical Engineering Informatics,
<a href="http://mbi-wiki.uni-wuppertal.de/">http://mbi-wiki.uni-wuppertal.de/</a>,
2015.</p>
</li>
</ol>
<h2 id="Code">Code<a class="anchor-link" href="#Code">¶</a></h2><div id="sec:cod"></div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load</span> CATIA-and-SIMULIA-Scripting-and-Automation-with-Python.py
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="sd">"""</span>
<span class="sd">Developed by:</span>
<span class="sd">Neal Gordon</span>
<span class="sd">NobleTek</span>
<span class="sd">nealagordon@gmail.com</span>

<span class="sd">Requires a CATIA license with the Generative Part Analysis (GPS) to run</span>
<span class="sd">"""</span>

<span class="c1"># import python modules</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">win32com.client</span> <span class="k">import</span> <span class="n">Dispatch</span>

<span class="c1"># Connecting to windows COM </span>
<span class="n">CATIA</span> <span class="o">=</span> <span class="n">Dispatch</span><span class="p">(</span><span class="s1">'CATIA.Application'</span><span class="p">)</span>
<span class="c1"># optional CATIA visibility</span>
<span class="n">CATIA</span><span class="o">.</span><span class="n">Visible</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># Create an empty part</span>
<span class="n">partDocument1</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">Documents</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="s2">"Part"</span><span class="p">)</span>

<span class="c1"># Create the point that the plane and sketch reference</span>
<span class="n">Xcoord</span><span class="o">=</span><span class="mi">100</span>
<span class="n">Ycoord</span><span class="o">=</span><span class="mi">100</span>
<span class="n">Zcoord</span><span class="o">=</span><span class="mi">100</span>
<span class="n">NewPoint</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">HybridShapeFactory</span><span class="o">.</span><span class="n">AddNewPointCoord</span><span class="p">(</span><span class="n">Xcoord</span><span class="p">,</span> <span class="n">Ycoord</span><span class="p">,</span> <span class="n">Zcoord</span><span class="p">)</span>
<span class="n">Mainbody</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">MainBody</span>
<span class="n">Mainbody</span><span class="o">.</span><span class="n">InsertHybridShape</span><span class="p">(</span><span class="n">NewPoint</span><span class="p">)</span>

<span class="c1"># Create reference plane for sketch</span>
<span class="n">AxisXY</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">OriginElements</span><span class="o">.</span><span class="n">PlaneXY</span>
<span class="n">Referenceplane</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">CreateReferenceFromObject</span><span class="p">(</span><span class="n">AxisXY</span><span class="p">)</span>
<span class="n">Referencepoint</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">CreateReferenceFromObject</span><span class="p">(</span><span class="n">NewPoint</span><span class="p">)</span>
<span class="n">NewPlane</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">HybridShapeFactory</span><span class="o">.</span><span class="n">AddNewPlaneOffsetPt</span><span class="p">(</span><span class="n">Referenceplane</span><span class="p">,</span> <span class="n">Referencepoint</span><span class="p">)</span>
<span class="n">Mainbody</span><span class="o">.</span><span class="n">InsertHybridShape</span><span class="p">(</span><span class="n">NewPlane</span><span class="p">)</span>

<span class="c1"># create sketch</span>
<span class="n">sketches1</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">Bodies</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="s2">"PartBody"</span><span class="p">)</span><span class="o">.</span><span class="n">Sketches</span>
<span class="n">reference1</span> <span class="o">=</span> <span class="n">partDocument1</span><span class="o">.</span><span class="n">part</span><span class="o">.</span><span class="n">OriginElements</span><span class="o">.</span><span class="n">PlaneXY</span>
<span class="n">NewSketch</span> <span class="o">=</span> <span class="n">sketches1</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">reference1</span><span class="p">)</span>
<span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">InWorkObject</span> <span class="o">=</span> <span class="n">NewSketch</span>

<span class="c1">#Drawing the sketch</span>
<span class="n">NewSketch</span><span class="o">.</span><span class="n">OpenEdition</span><span class="p">()</span>
<span class="c1">#                                  Start (H,   V)  End(H,V)</span>
<span class="n">NewLine1</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">0</span>  <span class="p">,</span> <span class="mi">0</span>  <span class="p">,</span> <span class="mi">0</span>   <span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">NewLine2</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">0</span>  <span class="p">,</span> <span class="mi">50</span> <span class="p">,</span> <span class="mi">50</span>  <span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">NewLine3</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">50</span> <span class="p">,</span> <span class="mi">50</span> <span class="p">,</span> <span class="mi">50</span>  <span class="p">,</span><span class="mi">55</span><span class="p">)</span>
<span class="n">NewLine4</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">50</span> <span class="p">,</span> <span class="mi">55</span> <span class="p">,</span> <span class="mi">150</span> <span class="p">,</span><span class="mi">55</span><span class="p">)</span>
<span class="n">NewLine5</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">55</span> <span class="p">,</span> <span class="mi">150</span>  <span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="n">NewLine6</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span> <span class="p">,</span> <span class="mi">50</span>  <span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">NewLine7</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">50</span> <span class="p">,</span> <span class="o">-</span><span class="mi">5</span> <span class="p">,</span> <span class="mi">75</span>  <span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="n">NewLine8</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">150</span> <span class="p">,</span> <span class="o">-</span><span class="mi">5</span> <span class="p">,</span> <span class="mi">125</span>  <span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="n">NewLine9</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">125</span> <span class="p">,</span> <span class="o">-</span><span class="mi">5</span> <span class="p">,</span> <span class="mi">125</span>  <span class="p">,</span><span class="mi">25</span><span class="p">)</span>
<span class="n">NewLine0</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">125</span> <span class="p">,</span> <span class="mi">25</span> <span class="p">,</span> <span class="mi">75</span>  <span class="p">,</span><span class="mi">25</span><span class="p">)</span>
<span class="n">NewLine11</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">75</span> <span class="p">,</span> <span class="mi">25</span> <span class="p">,</span> <span class="mi">75</span>  <span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="n">NewLine12</span> <span class="o">=</span> <span class="n">NewSketch</span><span class="o">.</span><span class="n">Factory2D</span><span class="o">.</span><span class="n">CreateLine</span><span class="p">(</span><span class="mi">50</span> <span class="p">,</span> <span class="mi">0</span>  <span class="p">,</span> <span class="mi">0</span>   <span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">NewSketch</span><span class="o">.</span><span class="n">CloseEdition</span><span class="p">()</span>

<span class="c1"># Create a pad from sketch</span>
<span class="n">LengthBlock</span><span class="o">=</span><span class="mi">50</span>
<span class="n">NewBlock</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">ShapeFactory</span><span class="o">.</span><span class="n">AddNewPad</span> <span class="p">(</span><span class="n">NewSketch</span><span class="p">,</span> <span class="n">LengthBlock</span><span class="p">)</span>
<span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

<span class="c1"># Assign Material</span>
<span class="n">MatManager</span><span class="o">=</span><span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">GetItem</span><span class="p">(</span><span class="s2">"CATMatManagerVBExt"</span><span class="p">)</span>
<span class="n">hk</span><span class="o">=</span><span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">MainBody</span>
<span class="n">systempath</span><span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">SystemService</span><span class="o">.</span><span class="n">Environ</span><span class="p">(</span><span class="s2">"CATDocView"</span><span class="p">)</span>
<span class="n">path</span><span class="o">=</span> <span class="s2">"C:</span><span class="se">\\</span><span class="s2">Program Files</span><span class="se">\\</span><span class="s2">Dassault Systemes</span><span class="se">\\</span><span class="s2">B23\win_b64</span><span class="se">\\</span><span class="s2">startup</span><span class="se">\\</span><span class="s2">materials</span><span class="se">\\</span><span class="s2">Catalog.CATMaterial"</span>
<span class="n">MatDoc</span><span class="o">=</span><span class="n">CATIA</span><span class="o">.</span><span class="n">Documents</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">oMaterial</span><span class="o">=</span><span class="n">MatDoc</span><span class="o">.</span><span class="n">Families</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="s2">"Metal"</span><span class="p">)</span><span class="o">.</span><span class="n">Materials</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="s2">"Steel"</span><span class="p">)</span>
<span class="n">MatManager</span><span class="o">.</span><span class="n">ApplyMaterialOnBody</span> <span class="p">(</span><span class="n">hk</span><span class="p">,</span><span class="n">oMaterial</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">MatDoc</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>


<span class="c1"># Activate the Generative Structural Analysis (GPS) Workbench</span>
<span class="n">PartDoc</span><span class="o">=</span><span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span>
<span class="n">CATIA</span><span class="o">.</span><span class="n">StartWorkbench</span> <span class="p">(</span><span class="s2">"GPSCfg"</span><span class="p">)</span>
<span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">Import</span><span class="p">(</span><span class="n">PartDoc</span><span class="p">)</span>
<span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">AnalysisModels</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">RunTransition</span> <span class="p">(</span><span class="s2">"CATGPSStressAnalysis_template"</span><span class="p">)</span>
<span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveWindow</span><span class="o">.</span><span class="n">ActiveViewer</span><span class="o">.</span><span class="n">Reframe</span> <span class="p">()</span>

<span class="c1"># Create a Mesh</span>
<span class="n">mesh</span><span class="o">=</span><span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">AnalysisModels</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">MeshManager</span><span class="o">.</span><span class="n">AnalysisMeshParts</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">SetGlobalSpecification</span> <span class="p">(</span><span class="s2">"SizeValue"</span><span class="p">,</span> <span class="s2">"2.5 mm"</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">SetGlobalSpecification</span> <span class="p">(</span><span class="s2">"AbsoluteSag"</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">SetGlobalSpecification</span> <span class="p">(</span><span class="s2">"AbsoluteSagValue"</span><span class="p">,</span> <span class="s2">"1.0 mm"</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">SetGlobalSpecification</span> <span class="p">(</span><span class="s2">"ElementOrder"</span><span class="p">,</span> <span class="s2">"Parabolic"</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

<span class="c1"># Define Constraints</span>
<span class="n">analysisSet1</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">AnalysisModels</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">AnalysisCases</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">AnalysisSets</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">analysisEntity1</span> <span class="o">=</span> <span class="n">analysisSet1</span><span class="o">.</span><span class="n">AnalysisEntities</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="s2">"SAMClamp"</span><span class="p">)</span>
<span class="n">reference1</span> <span class="o">=</span> <span class="n">partDocument1</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">CreateReferenceFromName</span><span class="p">(</span><span class="s2">"Selection_RSur:(Face:(Brp:(Pad.1;0:(Brp:(Sketch.1;12)));None:();Cf11:());Pad.1_ResultOUT;Last;Z0;G4720)"</span><span class="p">)</span>
<span class="n">analysisEntity1</span><span class="o">.</span><span class="n">AddSupportFromProduct</span> <span class="p">(</span><span class="n">partDocument1</span><span class="o">.</span><span class="n">Product</span><span class="p">,</span> <span class="n">reference1</span><span class="p">)</span>

<span class="c1"># Defining the Load</span>
<span class="n">analysisSet2</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">AnalysisModels</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">AnalysisCases</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">AnalysisSets</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">analysisEntity2</span> <span class="o">=</span> <span class="n">analysisSet2</span><span class="o">.</span><span class="n">AnalysisEntities</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="s2">"SAMDistributedForce"</span><span class="p">)</span>
<span class="n">reference2</span> <span class="o">=</span> <span class="n">partDocument1</span><span class="o">.</span><span class="n">Part</span><span class="o">.</span><span class="n">CreateReferenceFromName</span><span class="p">(</span><span class="s2">"Selection_RSur:(Face:(Brp:(Pad.1;0:(Brp:(Sketch.1;5)));None:();Cf11:());Pad.1_ResultOUT;Last;Z0;G4720)"</span><span class="p">)</span>
<span class="n">analysisEntity2</span><span class="o">.</span><span class="n">AddSupportFromProduct</span> <span class="p">(</span><span class="n">partDocument1</span><span class="o">.</span><span class="n">Product</span><span class="p">,</span> <span class="n">reference2</span><span class="p">)</span> <span class="c1">#partDocument1 aus "leeres Part erstellen"</span>
<span class="n">basicComponent1</span> <span class="o">=</span> <span class="n">analysisEntity2</span><span class="o">.</span><span class="n">BasicComponents</span><span class="o">.</span><span class="n">GetItem</span><span class="p">(</span><span class="s2">"SAMForceAxis.1"</span><span class="p">)</span>
<span class="n">basicComponent1</span><span class="o">.</span><span class="n">SetValue</span> <span class="p">(</span><span class="s2">"Values"</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">basicComponent2</span> <span class="o">=</span> <span class="n">analysisEntity2</span><span class="o">.</span><span class="n">BasicComponents</span><span class="o">.</span><span class="n">GetItem</span><span class="p">(</span><span class="s2">"SAMForceVector.1"</span><span class="p">)</span>
<span class="n">basicComponent2</span><span class="o">.</span><span class="n">SetDimensions</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">basicComponent2</span><span class="o">.</span><span class="n">SetValue</span> <span class="p">(</span><span class="s2">"Values"</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">)</span>
<span class="n">basicComponent2</span><span class="o">.</span><span class="n">SetValue</span> <span class="p">(</span><span class="s2">"Values"</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">)</span>
<span class="n">basicComponent2</span><span class="o">.</span><span class="n">SetValue</span> <span class="p">(</span><span class="s2">"Values"</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">)</span>

<span class="c1"># Perform Calculation</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Performing Calculaution'</span><span class="p">)</span>
<span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">AnalysisModels</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">AnalysisCases</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Compute</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Calculaution Complete'</span><span class="p">)</span>

<span class="c1"># Export text file with von-mises stress</span>
<span class="n">analysisSet1</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">AnalysisModels</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">AnalysisCases</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">AnalysisSets</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">analysisImage1</span> <span class="o">=</span> <span class="n">analysisSet1</span><span class="o">.</span><span class="n">AnalysisImages</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="s2">"StressVonMises_Iso_Smooth"</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">Folder</span> <span class="o">=</span> <span class="n">CATIA</span><span class="o">.</span><span class="n">FileSystem</span><span class="o">.</span><span class="n">GetFolder</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="n">analysisImage1</span><span class="o">.</span><span class="n">ExportDataInGlobalAxis</span><span class="p">(</span><span class="n">Folder</span><span class="p">,</span> <span class="s2">"mises"</span><span class="p">,</span> <span class="s2">"txt"</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Created stress text file"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'nagordon-github'; // required: replace example with your forum shortname

                    var disqus_identifier = 'catia-and-simulia-scripting-and-automation-with-python';
                var disqus_url = 'http://ifcuriousthenlearn.com/blog/2015/06/10/catia-and-simulia-scripting-and-automation-with-python/';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="https://www.linkedin.com/profile/public-profile-settings?trk=prof-edit-edit-public_profile"><i class="fa fa-linkedin-square fa-lg"></i> LinkedIn</a></li>
    <li class="list-group-item"><a href="https://github.com/nagordon"><i class="fa fa-github-square fa-lg"></i> GitHub</a></li>
    <li class="list-group-item"><a href="http://stackoverflow.com/users/2438993/nagordon"><i class="fa fa-stackoverflow-square fa-lg"></i> StackOverflow</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Recent Posts -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
  <ul class="list-group" id="recentposts">
    <li class="list-group-item"><a href="http://ifcuriousthenlearn.com/blog/2017/05/29/brick-stacking/">An investigation of the Brick Stacking Problem</a></li>
    <li class="list-group-item"><a href="http://ifcuriousthenlearn.com/blog/2016/08/20/pythoncode-vs-excel/">Calculations with Python Code or Excel Spreadsheets</a></li>
    <li class="list-group-item"><a href="http://ifcuriousthenlearn.com/blog/2016/08/14/logical-indexing-with-python-excel/">Logical Indexing with Python and Excel</a></li>
    <li class="list-group-item"><a href="http://ifcuriousthenlearn.com/blog/2016/06/05/sage-embed/">Sage Math Tool</a></li>
    <li class="list-group-item"><a href="http://ifcuriousthenlearn.com/blog/2016/05/07/what-open-source-means/">Understanding and using technology</a></li>
  </ul>
</li>
<!-- End Sidebar/Recent Posts -->

<!-- Sidebar/Categories -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Categories</span></h4>
  <ul class="list-group" id="categories">
    <li class="list-group-item">
      <a href="http://ifcuriousthenlearn.com/category/aviation.html"><i class="fa fa-folder-open fa-lg"></i>Aviation</a>
    </li>
    <li class="list-group-item">
      <a href="http://ifcuriousthenlearn.com/category/computing.html"><i class="fa fa-folder-open fa-lg"></i>computing</a>
    </li>
    <li class="list-group-item">
      <a href="http://ifcuriousthenlearn.com/category/engineering.html"><i class="fa fa-folder-open fa-lg"></i>Engineering</a>
    </li>
    <li class="list-group-item">
      <a href="http://ifcuriousthenlearn.com/category/tools.html"><i class="fa fa-folder-open fa-lg"></i>Tools</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Categories -->

<!-- Sidebar/Github -->
<li class="list-group-item">
  <h4><i class="fa fa-github fa-lg"></i><span class="icon-label">GitHub Repos</span></h4>
  <div id="gh_repos">
    <p class="list-group-item">Status updating...</p>
  </div>
</li>
<!-- End Sidebar/Github -->

<!-- Sidebar/Links -->
<li class="list-group-item">
  <h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
  <ul class="list-group" id="links">
    <li class="list-group-item">
      <a href="http://getpelican.com/" target="_blank">Pelican</a>
    </li>
    <li class="list-group-item">
      <a href="http://python.org/" target="_blank">Python.org</a>
    </li>
    <li class="list-group-item">
      <a href="https://www.scipy.org/" target="_blank">Scipy.org</a>
    </li>
    <li class="list-group-item">
      <a href="http://jinja.pocoo.org/" target="_blank">Jinja2</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Links -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2017 Neal Gordon
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://ifcuriousthenlearn.com/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://ifcuriousthenlearn.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://ifcuriousthenlearn.com/theme/js/respond.min.js"></script>

    <script src="http://ifcuriousthenlearn.com/theme/js/bodypadding.js"></script>

<!-- GitHub JS Code -->
<script type="text/javascript">
$(document).ready(function () {
  if (!window.jXHR) {
    var jxhr = document.createElement('script');
    jxhr.type = 'text/javascript';
    jxhr.src = 'http://ifcuriousthenlearn.com/theme/js/jXHR.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(jxhr, s);
  }

  github.showRepos({
    user: 'nagordon',
    count: 5,
    skip_forks: false,
    target: '#gh_repos'
  });
});
</script>
<script src="http://ifcuriousthenlearn.com/theme/js/github.js" type="text/javascript"></script>
<!-- End GitHub JS Code -->
    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'nagordon-github'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-65272251-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->


</body>
</html>